{"componentChunkName":"component---node-modules-rocketseat-gatsby-theme-docs-core-src-templates-docs-query-js","path":"/blocks/block-controller","result":{"data":{"mdx":{"id":"c4893559-af0e-5ee1-b6b2-2e1b92f2f18c","excerpt":"Tijdelijk... nog van de oude docs: Develop the new block Every block is different but we will give some common examples on how to expand your block. Block thatâ€¦","fields":{"slug":"/blocks/block-controller/"},"frontmatter":{"title":"Block controller","description":"where you control the block.","image":null,"disableTableOfContents":null},"body":"var _excluded = [\"components\"];\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n/* @jsxRuntime classic */\n/* @jsx mdx */\n\nvar _frontmatter = {\n  \"title\": \"Block controller\",\n  \"description\": \"where you control the block.\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", {\n    \"id\": \"tijdelijk-nog-van-de-oude-docs\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h1\",\n    \"href\": \"#tijdelijk-nog-van-de-oude-docs\",\n    \"aria-label\": \"tijdelijk nog van de oude docs permalink\",\n    \"className\": \"anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Tijdelijk... nog van de oude docs:\"), mdx(\"h2\", {\n    \"id\": \"develop-the-new-block\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#develop-the-new-block\",\n    \"aria-label\": \"develop the new block permalink\",\n    \"className\": \"anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Develop the new block\"), mdx(\"p\", null, \"Every block is different but we will give some common examples on how to expand your block.\"), mdx(\"h3\", {\n    \"id\": \"block-that-displays-an-x-amount-of-customposts\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#block-that-displays-an-x-amount-of-customposts\",\n    \"aria-label\": \"block that displays an x amount of customposts permalink\",\n    \"className\": \"anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Block that displays an x amount of (custom)posts\"), mdx(\"p\", null, \"Take a look at the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"news-recent.php\"), \" block in the parent theme. You will find a method block_context().\\nWhen going through these lines you will find several notable things.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-php\",\n    \"metastring\": \"lineNumbers=true\",\n    \"lineNumbers\": \"true\"\n  }, \" public function block_context($context): array\\n   {\\n      $amount = get_field('amount') ? get_field('amount') : 3;\\n      $items = latest_items_query('news', $amount);\\n      $context['items'] = $items;\\n      $context['card_type'] = 'news';\\n      $context['holder_classes'] = 'col-12 col-md-6 col-lg-4';\\n      $message = __(\\\"You haven't added any news yet, so this block will be empty.\\\", \\\"wp-lemon\\\");\\n\\n      if ($items->found_posts == 0) {\\n         self::add_notification($message, 'warning');\\n      }\\n\\n      return $context;\\n   }\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"wp-lemon comes with a set of predefined queries. Here we use latest_items_query() to get the latest posts of a specific posttype\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"We have a card_type variable that defines what card type will be loaded.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"We have a add_notification method that will setup a notification inside the block when previewed in the backend.\")), mdx(\"h3\", {\n    \"id\": \"block-that-displays-a-post-archive-with-load-more-button\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#block-that-displays-a-post-archive-with-load-more-button\",\n    \"aria-label\": \"block that displays a post archive with load more button permalink\",\n    \"className\": \"anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Block that displays a post archive with load more button\"), mdx(\"p\", null, \"Take a look at the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"news-overview.php\"), \" block in the parent theme. You will again find a method block_context() that will query the data from the database and add it to the block context.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-php\",\n    \"metastring\": \"lineNumbers=true\",\n    \"lineNumbers\": \"true\"\n  }, \"   public function block_context($context): array\\n   {\\n      $items = archive_query('news', 6); // query the news posttype\\n      $context['items'] = $items;\\n      $context['nav'] = true; // show nav\\n      $context['count'] = get_total_posts('news', count($items)); // get a count array that feeds information to the postholder.\\n      $context['post_type'] = 'news'; // sets post type for the ajax calls.\\n      $context['card_type'] = 'news'; // sets the twig partial to render the actual posts in the loop.\\n      $context['holder_classes'] = 'col-12 col-md-6 col-lg-4'; // holder classes around the cards in the loop.\\n\\n      if (isset($this->fields['show_filter']) && $this->fields['show_filter'] == true) {\\n         $context['show_filter'] = true;\\n         $context['terms'] = get_terms('category', array('hide_empty' => true));\\n      }\\n\\n      // add notification when no posts are found.\\n      if ($items->found_posts == 0) {\\n         self::add_notification(__('You haven\\\\'t added any news yet, so this block will be empty.', 'wp-lemon'), 'warning');\\n      }\\n\\n      return $context;\\n   }\\n\")), mdx(\"p\", null, \"The linked \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"blocks/news-overview.twig\"), \" file will include \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"components/archive-loop.twig\"), \" that will display the initial posts and setup everything for receiving new posts via an ajax call.\"), mdx(\"p\", null, \"When reusing above code make sure to:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"set the post type correctly\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"create a new card twig file\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"include the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"components/archive-loop.twig\"), \" inside your twig file that is linked to your block.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Update the notice to inform the administrator/editors of the website when no posts are found of the posttype you want to query.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"include the right functions in your file like so\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-php\",\n    \"metastring\": \"lineNumbers=true\",\n    \"lineNumbers\": \"true\"\n  }, \"namespace WP_Lemon\\\\Child\\\\Blocks;\\n\\nuse HighGround\\\\Bulldozer\\\\BlockRenderer;\\n\\n++ use function WP_Lemon\\\\API\\\\archive_query;\\n++ use function WP_Lemon\\\\API\\\\get_total_posts;\\n\")), mdx(\"h3\", {\n    \"id\": \"block-with-custom-assets\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#block-with-custom-assets\",\n    \"aria-label\": \"block with custom assets permalink\",\n    \"className\": \"anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Block with custom assets\"), mdx(\"p\", null, \"You might want to add a specific asset to the blocks context as it is only used by this specific block. You can use the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"asset()\"), \" helper function for that.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-php\",\n    \"metastring\": \"lineNumbers=true\",\n    \"lineNumbers\": \"true\"\n  }, \"    public function block_context($context): array\\n    {\\n      // Check if shape exists.\\n      if(true == asset('images/banner.png')->exists()){\\n            // get URL to image/shape\\n            $context['banner_uri'] = asset('images/banner.png')->uri();\\n      }\\n\\n      // get contents of the svg to use directly in to your block.\\n      $context['sphere'] = asset('images/sphere.svg')->contents();\\n\\n      return $context;\\n    }\\n\")), mdx(\"h3\", {\n    \"id\": \"block-with-custom-acf-fields\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#block-with-custom-acf-fields\",\n    \"aria-label\": \"block with custom acf fields permalink\",\n    \"className\": \"anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Block with custom acf fields\"), mdx(\"p\", null, \"Blocks can be added in two ways. You can add them by using the administrative interface of ACF. Fields created this way get saved to json and stored in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"resources/acf-json\"), \". These fields are thus added to version control.\"), mdx(\"p\", null, \"For a more rigid approach of adding fields you can use the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"add_fields()\"), \" method.\\nHere we see a field being added to our already registered group. Fields are added via a pretty straightforward using the OOP method of \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/StoutLogic/acf-builder\"\n  }, \"ACF Builder\"), \". You can read the docs on how to add \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/StoutLogic/acf-builder/wiki/fields\"\n  }, \"fields\"), \" and see the per field type \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/StoutLogic/acf-builder/wiki/field-types\"\n  }, \"examples\"), \".\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-php\",\n    \"metastring\": \"lineNumbers=true\",\n    \"lineNumbers\": \"true\"\n  }, \"    public function add_fields(): object\\n    {\\n\\n        $this->registered_fields\\n            ->addImage('image', [\\n                'label' => __('Image', 'wp-lemon'),\\n                'instructions' => '',\\n                'required' => 1,\\n                'return_format' => 'id',\\n                'preview_size' => 'thumbnail',\\n                'library' => 'all',\\n            ]);\\n\\n        return $this->registered_fields;\\n    }\\n\")), mdx(\"h3\", {\n    \"id\": \"block-that-needs-conditional-modifier-classes\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#block-that-needs-conditional-modifier-classes\",\n    \"aria-label\": \"block that needs conditional modifier classes permalink\",\n    \"className\": \"anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Block that needs conditional modifier classes\"), mdx(\"p\", null, \"You might want to add conditional classes based on a field setting. This is where \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$this->add_modifier_class('yourmodifier');\"), \" comes in.\\nThis method adds a BEM modifier class to your block. An example:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-php\",\n    \"metastring\": \"lineNumbers=true\",\n    \"lineNumbers\": \"true\"\n  }, \"    public function block_context($context): array\\n    {\\n    \\n        if (isset($this->fields['show_pagination']) && true == $this->fields['show_pagination']) {\\n            $context['show_pagination'] = true;\\n            $this->add_modifier_class('has-pagination');\\n        }\\n    \\n        return $context;\\n    }\\n\")), mdx(\"p\", null, \"will result in\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-html\",\n    \"metastring\": \"lineNumbers=true\",\n    \"lineNumbers\": \"true\"\n  }, \"<div class=\\\"acf-block slider slider--has-pagination\\\" id=\\\"block_5f8ffdc0349e1\\\">\\n...\\n</div>\\n\")));\n}\n;\nMDXContent.isMDXComponent = true;","headings":[{"depth":1,"value":"Tijdelijk... nog van de oude docs:"},{"depth":2,"value":"Develop the new block"},{"depth":3,"value":"Block that displays an x amount of (custom)posts"},{"depth":3,"value":"Block that displays a post archive with load more button"},{"depth":3,"value":"Block with custom assets"},{"depth":3,"value":"Block with custom acf fields"},{"depth":3,"value":"Block that needs conditional modifier classes"}]}},"pageContext":{"slug":"/blocks/block-controller/","prev":{"label":"Declaration (json)","link":"/blocks/block-declaration"},"next":{"label":"View (twig)","link":"/blocks/block-view"},"repositoryEditUrl":"https://github.com/Studio-Lemon/wp-lemon-docs/tree/master/src/docs/blocks/block-controller.mdx","repositoryProvider":"GitHub"}},"staticQueryHashes":["1954253342","2328931024","2501019404","973074209"]}