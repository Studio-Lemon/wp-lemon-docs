"use strict";(globalThis.webpackChunkwp_lemon_docs=globalThis.webpackChunkwp_lemon_docs||[]).push([[7321],{7982(e,n,t){t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>a});const o=JSON.parse('{"id":"migrations/3-4","title":"Migrate to wp-lemon 4","description":"How to update to the newest version of wp-lemon","source":"@site/docs/migrations/3-4.mdx","sourceDirName":"migrations","slug":"/migrations/3-4","permalink":"/wp-lemon-docs/migrations/3-4","draft":false,"unlisted":false,"editUrl":"https://github.com/Studio-Lemon/wp-lemon-docs/tree/master/docs/migrations/3-4.mdx","tags":[],"version":"current","frontMatter":{"title":"Migrate to wp-lemon 4","description":"How to update to the newest version of wp-lemon","disableTableOfContents":true},"sidebar":"docsSidebar","previous":{"title":"Migrate to wp-lemon 5","permalink":"/wp-lemon-docs/migrations/4-5"},"next":{"title":"Migrate to wp-lemon 3","permalink":"/wp-lemon-docs/migrations/2-3"}}');var i=t(4848),s=t(8453);const r={title:"Migrate to wp-lemon 4",description:"How to update to the newest version of wp-lemon",disableTableOfContents:!0},d=void 0,l={},a=[{value:"Before we get started",id:"before-we-get-started",level:2},{value:"Upgrade steps",id:"upgrade-steps",level:2},{value:"Step 1. Set new major version of wp-lemon",id:"step-1-set-new-major-version-of-wp-lemon",level:3},{value:"Step 2. Update child-theme dependencies",id:"step-2-update-child-theme-dependencies",level:3},{value:"Step 3. Move backend() function outside of domReady in editor.js",id:"step-3-move-backend-function-outside-of-domready-in-editorjs",level:3},{value:"Step 4. Run update-parent command",id:"step-4-run-update-parent-command",level:3},{value:"Step 5. Run production build",id:"step-5-run-production-build",level:3},{value:"Step 6. Change the following in your code:",id:"step-6-change-the-following-in-your-code",level:3},{value:"PHP Helper functions moved:",id:"php-helper-functions-moved",level:4},{value:"PHP Query helpers functions moved:",id:"php-query-helpers-functions-moved",level:4},{value:"Block migration: acf/testimonial to acf/circle-text",id:"block-migration-acftestimonial-to-acfcircle-text",level:4},{value:"Block migration: acf/faq to acf/accordion",id:"block-migration-acffaq-to-acfaccordion",level:4},{value:"Visual/Code check",id:"visualcode-check",level:2},{value:"Deploy",id:"deploy",level:2}];function c(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"Welcome to version 4.0 of wp-lemon. In this guide we will go over the details to upgrade your current 3.x website to the 4.x."}),"\n",(0,i.jsx)(n.h2,{id:"before-we-get-started",children:"Before we get started"}),"\n",(0,i.jsx)(n.p,{children:"Please make sure you have the latest version of your project checked out and have a recent database and media files to check your website locally."}),"\n",(0,i.jsx)(n.h2,{id:"upgrade-steps",children:"Upgrade steps"}),"\n",(0,i.jsx)(n.p,{children:"Follow the next steps to upgrade your project to use wp-lemon 4."}),"\n",(0,i.jsx)(n.h3,{id:"step-1-set-new-major-version-of-wp-lemon",children:"Step 1. Set new major version of wp-lemon"}),"\n",(0,i.jsx)(n.p,{children:"Navigate to your composer.json file in the project root and update it as follows."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'-    "satispress/wp-lemon": "^3.0",\n+    "satispress/wp-lemon": "^4.0",\n'})}),"\n",(0,i.jsx)(n.h3,{id:"step-2-update-child-theme-dependencies",children:"Step 2. Update child-theme dependencies"}),"\n",(0,i.jsx)(n.p,{children:"Navigate to your child theme and open package.json and update the following dependencies to at least these versions."}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u26a0\ufe0f\nMake sure not to delete/overwrite extra dependencies that you may have included."}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'"devDependencies": {\n    "@wordpress/browserslist-config": "^5.17",\n    "basebuilder-config": "^3.3.7",\n    "prettier": "^2.8",\n    "prettier-plugin-twig-melody": "^0.4.6",\n    "stylelint": "^15.6",\n    "stylelint-basebuilder": "^2.3"\n},\n"dependencies": {\n    "@popperjs/core": "^2.11.8",\n    "aos": "^3.0.0-beta.6",\n    "bootstrap": "^5.3",\n    "lodash.throttle": "^4.1.1",\n    "swiper": "^10.0",\n    "vanilla-lazyload": "17.8"\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"step-3-move-backend-function-outside-of-domready-in-editorjs",children:"Step 3. Move backend() function outside of domReady in editor.js"}),"\n",(0,i.jsx)(n.p,{children:"move backend() function outside of domReady"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"import domReady from '@wordpress/dom-ready';\nimport backend from 'parentThemeScripts/components/functions-backend';\n\n++ backend();\ndomReady(() => {\n    acf.addAction('render_block_preview', function (el, block) {\n        -- backend();\n    });\n});\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"step-4-run-update-parent-command",children:"Step 4. Run update-parent command"}),"\n",(0,i.jsxs)(n.p,{children:["Open a new console in your child theme and run the following command: ",(0,i.jsx)(n.code,{children:"yarn run update-parent"})]}),"\n",(0,i.jsx)(n.p,{children:"This will update both PHP and node dependencies to their latest versions."}),"\n",(0,i.jsx)(n.h3,{id:"step-5-run-production-build",children:"Step 5. Run production build"}),"\n",(0,i.jsxs)(n.p,{children:["Open a new console in your child theme and run the following command: ",(0,i.jsx)(n.code,{children:"yarn run production"}),"\nThis will create a fresh build with the new dependencies. If the build fails, please try to debug the error or open a new ticket."]}),"\n",(0,i.jsx)(n.h3,{id:"step-6-change-the-following-in-your-code",children:"Step 6. Change the following in your code:"}),"\n",(0,i.jsx)(n.h4,{id:"php-helper-functions-moved",children:"PHP Helper functions moved:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"search for usage of format_phone_number and use new location"}),"\n",(0,i.jsx)(n.li,{children:"search for usage of get_fluent_form and use new location"}),"\n",(0,i.jsx)(n.li,{children:"search for usage of log_message and use new location"}),"\n",(0,i.jsx)(n.li,{children:"search for usage of get_svg_image and use new location"}),"\n",(0,i.jsx)(n.li,{children:"search for usage of post_type_name and use new location"}),"\n",(0,i.jsx)(n.li,{children:"search for usage of custom_archive_page and use get_archive_page instead"}),"\n",(0,i.jsx)(n.li,{children:"search for usage of language_switcher and use get_language_switcher instead"}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"php-query-helpers-functions-moved",children:"PHP Query helpers functions moved:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"search for latest_items_query and use new location"}),"\n",(0,i.jsx)(n.li,{children:"search for other_items_query and use new location"}),"\n",(0,i.jsx)(n.li,{children:"search for specific_items_query and use new location"}),"\n",(0,i.jsx)(n.li,{children:"search for archive_query and use new location"}),"\n",(0,i.jsx)(n.li,{children:"search for get_total_posts and use new location"}),"\n",(0,i.jsx)(n.li,{children:"search for adjacent_post_info and use new location"}),"\n",(0,i.jsx)(n.li,{children:"search for next_post and use previous_post_info instead"}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"block-migration-acftestimonial-to-acfcircle-text",children:"Block migration: acf/testimonial to acf/circle-text"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Search"}),(0,i.jsx)(n.th,{children:"Replace"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"acf/testimonial"}),(0,i.jsx)(n.td,{children:"acf/circle-text"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"field_testimonial"}),(0,i.jsx)(n.td,{children:"field_circle-text"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"field_testimonial"}),(0,i.jsx)(n.td,{children:"field_circle-text"})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"block-migration-acffaq-to-acfaccordion",children:"Block migration: acf/faq to acf/accordion"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Search"}),(0,i.jsx)(n.th,{children:"Replace"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"acf/faq"}),(0,i.jsx)(n.td,{children:"acf/accordion"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"acf/faq-item"}),(0,i.jsx)(n.td,{children:"acf/accordion-item"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"field_faq-item"}),(0,i.jsx)(n.td,{children:"field_accordion-item"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"visualcode-check",children:"Visual/Code check"}),"\n",(0,i.jsx)(n.p,{children:"Since this is a new major version please check the build locally with the latest database and media files. Check for any visual differences. If you find a major difference please try to debug or open a ticket."}),"\n",(0,i.jsx)(n.p,{children:"If you've written custom code based on Swiper or Bootstrap, for example created a new block or a slider that involves on of these libraries, please check out the following migration guides."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Please update custom Swipers against ",(0,i.jsx)(n.a,{href:"https://swiperjs.com/migration-guide",children:"https://swiperjs.com/migration-guide"})]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"deploy",children:"Deploy"}),"\n",(0,i.jsxs)(n.p,{children:["Please follow the following guide to deploy the update to the production server. ",(0,i.jsx)(n.a,{href:"/deployment/updates#deploy-update",children:"Deploy update!"})]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453(e,n,t){t.d(n,{R:()=>r,x:()=>d});var o=t(6540);const i={},s=o.createContext(i);function r(e){const n=o.useContext(s);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),o.createElement(s.Provider,{value:n},e.children)}}}]);